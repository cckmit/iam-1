# Copyright (c) 2017 ~ 2025, the original author wangl.sir individual Inc,
# All rights reserved. Contact us <Wanglsir@gmail.com, 983708408@qq.com>
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# #### Environment(SpringCloud Feign for Uat) configuration. ####
#

#spring:
#  cloud:
#    #ipAddress: 
#    consul:
#      discovery:
#        enabled: true
#        register: true
#        prefer-ip-address: true # Solve the problem that the health check will fail in the consumer under docker
#        service-name: ${spring.application.name}
#        hostname: localhost
#        port: ${server.port} # Port of registration service
#        healthCheckPath: /actuator/health
#        healthCheckInterval: 10s

#management.endpoints.web.exposure.include=*

eureka:
  instance:
    leaseRenewalIntervalInSeconds: 10
    leaseExpirationDurationInSeconds: 30
    prefer-ip-address: true
    #instance-id: ${spring.cloud.client.ipAddress}:${server.port}
    metadataMap:
      instanceId: ${vcap.application.instance_id:${spring.application.name}:${spring.application.instance_id:${server.port}}}
  # see:https://github.com/Netflix/eureka/blob/master/eureka-client/src/main/java/com/netflix/discovery/EurekaClientConfig.java
  client:
    registerWithEureka: true # Default by true
    fetchRegistry: false # Default by false
    registryFetchIntervalSeconds: 30 # Default by 30
    gzipContent: true # Default by true
    eurekaConnectionIdleTimeoutSeconds: 30 # Default by true
    eurekaServerConnectTimeoutSeconds: 5 # Default by 5
    eurekaServerReadTimeoutSeconds: 8 # Default by 8
    eurekaServerTotalConnections: 200 # Default by 200(total max clients)
    eurekaServerTotalConnectionsPerHost: 50 # Default by 50(max clients)
    eurekaServiceUrlPollIntervalSeconds: 300 # Default by 300
    initialInstanceInfoReplicationIntervalSeconds: 40 # Default by 40
    instanceInfoReplicationIntervalSeconds: 30 # Default by 30

hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 1500

ribbon:
  connectTimeout: 9000
  readTimeout: 10000
  okToRetryOnAllOperations: true # Try again for all operations
  maxAutoRetriesNextServer: 2 # Number of retries for different instances of the same service
  maxAutoRetries: 1 # Same instance retries

feign:
  hystrix:
    enabled: true
